{
  "RestrictedSubnetAclEntryInTCPUnReserved": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "RestrictedSubnetAcl"
      },
      "RuleNumber": 90,
      "Protocol": 6,
      "PortRange": {
        "To": 65535,
        "From": 1024
      },
      "Egress": false,
      "RuleAction": "allow",
      "CidrBlock": "0.0.0.0/0"
    }
  },
  "RestrictedSubnetAclEntryInUDPUnReserved": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "RestrictedSubnetAcl"
      },
      "RuleNumber": 91,
      "Protocol": 17,
      "PortRange": {
        "To": 65535,
        "From": 1024
      },
      "Egress": false,
      "RuleAction": "allow",
      "CidrBlock": "0.0.0.0/0"
    }
  },
  "InternalSubnetAclEntryInUDPUnreserved": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "InternalSubnetAcl"
      },
      "RuleNumber": 103,
      "Protocol": 17,
      "PortRange": {
        "To": 65535,
        "From": 1024
      },
      "Egress": false,
      "RuleAction": "allow",
      "CidrBlock": "0.0.0.0/0"
    }
  },
  "RestrictedSubnetAcl": {
    "Type": "AWS::EC2::NetworkAcl",
    "Properties": {
      "VpcId": {
        "Ref": "PRIVATEEGRESSVPC"
      },
      "Tags": [
        {
          "Value": "RestrictedSubnetAcl",
          "Key": "Name"
        },
        {
          "Key": "Template",
          "Value": "VPC for private endpoints egress only"
        },
        {
          "Key": "info:environment",
          "Value": "Staging"
        },
        {
          "Key": "info:owner",
          "Value": "Versent"
        }
      ]
    }
  },
  "RestrictedSubnetAclEntryOutTCPUnReserved": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "RestrictedSubnetAcl"
      },
      "RuleNumber": 90,
      "Protocol": 6,
      "PortRange": {
        "To": 65535,
        "From": 1024
      },
      "Egress": true,
      "RuleAction": "allow",
      "CidrBlock": "0.0.0.0/0"
    }
  },
  "InternalSubnetAcl": {
    "Type": "AWS::EC2::NetworkAcl",
    "Properties": {
      "VpcId": {
        "Ref": "PRIVATEEGRESSVPC"
      },
      "Tags": [
        {
          "Value": "InternalSubnetAcl",
          "Key": "Name"
        },
        {
          "Key": "Template",
          "Value": "VPC for private endpoints egress only"
        },
        {
          "Key": "info:environment",
          "Value": "Staging"
        },
        {
          "Key": "info:owner",
          "Value": "Versent"
        }
      ]
    }
  },
  "RestrictedSubnetAclEntryOutTCPUnReservedIPv6": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "RestrictedSubnetAcl"
      },
      "RuleNumber": 92,
      "Protocol": 6,
      "Ipv6CidrBlock": "::/0",
      "Egress": true,
      "RuleAction": "allow",
      "PortRange": {
        "To": 65535,
        "From": 1024
      }
    }
  },
  "RestrictedSubnetAclEntryOutUDPUnReserved": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "RestrictedSubnetAcl"
      },
      "RuleNumber": 91,
      "Protocol": 17,
      "PortRange": {
        "To": 65535,
        "From": 1024
      },
      "Egress": true,
      "RuleAction": "allow",
      "CidrBlock": "0.0.0.0/0"
    }
  },
  "RestrictedSubnetAclEntryInUDPUnReservedIPv6": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "RestrictedSubnetAcl"
      },
      "RuleNumber": 93,
      "Protocol": 17,
      "Ipv6CidrBlock": "::/0",
      "Egress": false,
      "RuleAction": "allow",
      "PortRange": {
        "To": 65535,
        "From": 1024
      }
    }
  },
  "InternalSubnetAclEntryInTCPUnreservedIPv6": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "InternalSubnetAcl"
      },
      "RuleNumber": 104,
      "Protocol": 6,
      "Ipv6CidrBlock": "::/0",
      "Egress": false,
      "RuleAction": "allow",
      "PortRange": {
        "To": 65535,
        "From": 1024
      }
    }
  },
  "RestrictedSubnetAclEntryInTCPUnReservedIPv6": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "RestrictedSubnetAcl"
      },
      "RuleNumber": 92,
      "Protocol": 6,
      "Ipv6CidrBlock": "::/0",
      "Egress": false,
      "RuleAction": "allow",
      "PortRange": {
        "To": 65535,
        "From": 1024
      }
    }
  },
  "InternalSubnetAclEntryInUDPUnreservedIPv6": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "InternalSubnetAcl"
      },
      "RuleNumber": 105,
      "Protocol": 17,
      "Ipv6CidrBlock": "::/0",
      "Egress": false,
      "RuleAction": "allow",
      "PortRange": {
        "To": 65535,
        "From": 1024
      }
    }
  },
  "RestrictedSubnetAclEntryOutUDPUnReservedIPv6": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "RestrictedSubnetAcl"
      },
      "RuleNumber": 93,
      "Protocol": 17,
      "Ipv6CidrBlock": "::/0",
      "Egress": true,
      "RuleAction": "allow",
      "PortRange": {
        "To": 65535,
        "From": 1024
      }
    }
  },
  "InternalSubnetAclEntryIn": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "InternalSubnetAcl"
      },
      "RuleNumber": 100,
      "Protocol": -1,
      "PortRange": {
        "To": 65535,
        "From": 1
      },
      "Egress": false,
      "RuleAction": "allow",
      "CidrBlock": "172.16.0.0/16"
    }
  },
  "InternalSubnetAclEntryInTCPUnreserved": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "InternalSubnetAcl"
      },
      "RuleNumber": 102,
      "Protocol": 6,
      "PortRange": {
        "To": 65535,
        "From": 1024
      },
      "Egress": false,
      "RuleAction": "allow",
      "CidrBlock": "0.0.0.0/0"
    }
  },
  "InternalSubnetAclEntryOut": {
    "Type": "AWS::EC2::NetworkAclEntry",
    "Properties": {
      "NetworkAclId": {
        "Ref": "InternalSubnetAcl"
      },
      "RuleNumber": 100,
      "Protocol": -1,
      "PortRange": {
        "To": 65535,
        "From": 1
      },
      "Egress": true,
      "RuleAction": "allow",
      "CidrBlock": "172.16.0.0/16"
    }
  }
}